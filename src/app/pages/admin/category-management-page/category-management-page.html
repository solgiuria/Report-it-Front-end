<div class="management-page">
  <div class="container">
    
    <h1 class="page-title">Gesti√≥n de Categor√≠as y Subcategor√≠as</h1>

    <!-- SECCI√ìN CATEGOR√çAS -->
    <section class="section">
      <div class="section-header">
        <h2 class="section-title">Categor√≠as</h2>
        <button class="btn-add" (click)="toggleCategoryForm()">
          {{ showCategoryForm() ? '‚úï Cancelar' : '+ Nueva Categor√≠a' }}
        </button>
      </div>

      <!-- FORMULARIO CREAR CATEGOR√çA -->
      @if (showCategoryForm()) {
        <div class="form-card">
          <input 
            type="text" 
            class="form-input"
            placeholder="Nombre de la categor√≠a (ej: Medio Ambiente)"
            [(ngModel)]="newCategoryName"
            (keyup.enter)="handleCreateCategory()"
          />
          <button class="btn-create" (click)="handleCreateCategory()">
            Crear Categor√≠a
          </button>
        </div>
      }
      
      <div class="items-list">
        @for (category of categories(); track category.id) {
          <div class="item-card">
            <span class="item-name">{{ formatCategoryName(category.nombre) }}</span>
            <button 
              class="btn-delete-small" 
              (click)="handleDeleteCategory(category.id, category.nombre)"
              title="Eliminar categor√≠a"
            >
              üóëÔ∏è
            </button>
          </div>
        } @empty {
          <p class="empty-message">No hay categor√≠as registradas</p>
        }
      </div>
    </section>

    <!-- SECCI√ìN SUBCATEGOR√çAS -->
    <section class="section">
      <div class="section-header">
        <h2 class="section-title">Subcategor√≠as</h2>
        <button class="btn-add" (click)="toggleSubCategoryForm()">
          {{ showSubCategoryForm() ? '‚úï Cancelar' : '+ Nueva Subcategor√≠a' }}
        </button>
      </div>

      <!-- FORMULARIO CREAR SUBCATEGOR√çA -->
      @if (showSubCategoryForm()) {
        <div class="form-card">
          <select 
            class="form-select"
            [(ngModel)]="selectedCategoryId"
          >
            <option [ngValue]="0" disabled>Seleccionar categor√≠a</option>
            @for (category of categories(); track category.id) {
              <option [ngValue]="category.id">
                {{ formatCategoryName(category.nombre) }}
              </option>
            }
          </select>

          <input 
            type="text" 
            class="form-input"
            placeholder="Nombre de la subcategor√≠a (ej: Basura En V√≠a P√∫blica)"
            [(ngModel)]="newSubCategoryName"
            (keyup.enter)="handleCreateSubCategory()"
          />

          <button class="btn-create" (click)="handleCreateSubCategory()">
            Crear Subcategor√≠a
          </button>
        </div>
      }
      
      <div class="items-list">
        @for (sub of subCategories(); track sub.id) {
          <div class="item-card">
            <div class="item-info">
              <span class="item-name">{{ formatCategoryName(sub.nombre) }}</span>
              <span class="item-parent">{{ formatCategoryName(sub.tipo_reporte.nombre) }}</span>
            </div>
            <button 
              class="btn-delete-small" 
              (click)="handleDeleteSubCategory(sub.id, sub.nombre)"
              title="Eliminar subcategor√≠a"
            >
              üóëÔ∏è
            </button>
          </div>
        } @empty {
          <p class="empty-message">No hay subcategor√≠as registradas</p>
        }
      </div>
    </section> <!-- üëà ESTE FALTABA -->

  </div>
</div>
